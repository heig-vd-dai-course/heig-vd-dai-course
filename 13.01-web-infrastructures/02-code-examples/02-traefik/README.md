# Traefik

This [Traefik](https://traefik.io/traefik/) example shows how to use Traefik on
the virtual machine with Docker and Docker Compose.

## Prerequisites

You must have a domain name ready.

Update the [`.env`](.env) file with your own values:

- `TRAEFIK_ACME_EMAIL`: your email address - this is used to notify you about
  certificate expiration, nothing else
- `TRAEFIK_FULLY_QUALIFIED_DOMAIN_NAME`: the fully qualified domain name to
  access Traefik (e.g. `traefik.example.com` - **without** the `http` or
  `https`)

## Run the example

### Access the Traefik dashboard

Start the containers on the virtual machine:

```sh
# Start the containers
docker compose up -d
```

Open your browser and go to the fully qualified domain name of the Traefik
service you defined in the `.env` file with the `http` protocol, for example
`http://TRAEFIK_FULLY_QUALIFIED_DOMAIN_NAME`.

You should notice that the request is automatically redirected to the `https`
protocol. This is because the Traefik container is configured to redirect all
requests to the `https` protocol.

Depending on the time it takes for the certificate to be generated, you might
see a warning about the certificate not being valid. If this happens, wait a few
minutes and refresh the page.

> [!NOTE]
>
> Depending on your browser, you might need to clear the cache or open a private
> window to see the updated certificate. You can also force the `https` protocol
> by typing it explicitly in the address bar (e.g.
> `https://TRAEFIK_FULLY_QUALIFIED_DOMAIN_NAME`).

The page should now be secured with a valid certificate and a lock icon should
be displayed in the address bar.

You should now be able to access the Traefik dashboard with a valid HTTPS
certificate.

The certificate is generated by the [Let's Encrypt](https://letsencrypt.org/)
and are stored in the `acme.json` file under the `letsencrypt` Docker volume.
You can display its content with the following command from the current
directory:

```sh
# Display the content of the acme.json file
sudo cat ./letsencrypt/acme.json
```
